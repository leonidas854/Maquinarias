{% extends 'index.html' %}
{% load static %}

{% block title %}Seleccionar Máquina para Monitoreo{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body {
    background-color: #f9f9f9;
  }

  .card {
    border-radius: 12px;
  }

  .card-header {
    background: linear-gradient(90deg, #E61D2B 0%, #ff4b4b 100%);
    font-weight: bold;
    font-size: 1.4rem;
  }

  .form-select {
    padding: 12px;
    font-size: 1.1em;
  }

  #monitor-btn {
    transition: all 0.3s ease;
  }

  #monitor-btn:hover {
    background-color: #c01722;
    transform: scale(1.03);
  }

  .bi-display {
    vertical-align: middle;
    margin-right: 8px;
  }

  .fade-in {
    animation: fadeIn 0.6s ease-in-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5 fade-in">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-lg">
        <div class="card-header text-white text-center">
          <h2 class="mb-0">Sistema de Mantenimiento Predictivo con IA</h2>
        </div>
        <div class="card-body p-5">
          <h5 class="card-title mb-3">Seleccione una Máquina</h5>
          <p class="card-text mb-4">
            Elija una línea embotelladora para monitorear su estado en tiempo real,
            recibir diagnósticos automáticos y ejecutar simulaciones predictivas con inteligencia artificial.
          </p>
          <div class="mb-4">
            <select id="linea-select" class="form-select form-select-lg">
              <option value="">-- Seleccione una máquina --</option>
              {% for linea in lineas %}
                <option value="{{ linea.Nombre }}">{{ linea.Nombre }}</option>
              {% endfor %}
            </select>
          </div>
          <button id="monitor-btn" class="btn btn-primary btn-lg w-100" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
              class="bi bi-display" viewBox="0 0 16 16">
              <path
                d="M0 4s0-2 2-2h12s2 0 2 2v6s0 2-2 2h-4q0 1 .25 1.5H11a.5.5 0 0 1 0 1H5a.5.5 0 0 1 0-1h2.75q.25-.5.25-1.5H2s-2 0-2-2zm1.398-.855a.758.758 0 0 0-.254.302A1.46 1.46 0 0 0 1 4.01V10c0 .325.078.502.145.602.07.101.156.187.254.254a1.46 1.46 0 0 0 .592.302h11.996c.266 0 .435-.07.592-.302a.758.758 0 0 0 .254-.254c.067-.1.145-.277.145-.602V4.01c0-.325-.078-.502-.145-.602a.758.758 0 0 0-.254-.302A1.46 1.46 0 0 0 13.996 3H2.004c-.266 0-.435.07-.592.302z" />
            </svg>
            Ir al Dashboard
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const select = document.getElementById('linea-select');
    const button = document.getElementById('monitor-btn');

    select.addEventListener('change', () => {
      button.disabled = !select.value;
    });

    button.addEventListener('click', () => {
      const selectedLinea = select.value;
      if (selectedLinea) {
        window.location.href = `/qlearning/dashboard/${selectedLinea}/`;
      }
    });
  });
</script>
{% endblock %}
